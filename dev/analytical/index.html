<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Analytical estimations · MKtest.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://jmurga.github.io/MKtest.jl/analytical/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">MKtest.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Package Overview</span><ul><li class="is-active"><a class="tocitem" href>Analytical estimations</a><ul class="internal"><li><a class="tocitem" href="#Solving-\\alpha_{(x)}"><span>Solving <span>$\alpha_{(x)}$</span></span></a></li></ul></li><li><a class="tocitem" href="../data/">Processing data</a></li><li><a class="tocitem" href="../mk/">MK approaches</a></li></ul></li><li><span class="tocitem">Infering the rate and strength of adaptation</span><ul><li><a class="tocitem" href="../empirical/">Empirical estimation</a></li><li><a class="tocitem" href="../rates/">Rates</a></li><li><a class="tocitem" href="../input/">Input data</a></li><li><a class="tocitem" href="../summstat/">Summary statistics</a></li><li><a class="tocitem" href="../abc/">ABC inference</a></li><li><a class="tocitem" href="../multiple/">Multiple dataset</a></li></ul></li><li><a class="tocitem" href="../cli/">Command-Line interface</a></li><li><a class="tocitem" href="../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Package Overview</a></li><li class="is-active"><a href>Analytical estimations</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Analytical estimations</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/jmurga/MKtest.jl/blob/master/docs/src/analytical.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="MKtest-estimation"><a class="docs-heading-anchor" href="#MKtest-estimation">MKtest estimation</a><a id="MKtest-estimation-1"></a><a class="docs-heading-anchor-permalink" href="#MKtest-estimation" title="Permalink"></a></h1><h2 id="Solving-\\alpha_{(x)}"><a class="docs-heading-anchor" href="#Solving-\\alpha_{(x)}">Solving <span>$\alpha_{(x)}$</span></a><a id="Solving-\\alpha_{(x)}-1"></a><a class="docs-heading-anchor-permalink" href="#Solving-\\alpha_{(x)}" title="Permalink"></a></h2><p>Our method is based on the analytical solution of <span>$\alpha_{(x)}$</span> given a genetic scenario. The approach could be extended to any <em>DFE</em> and background selection values to get summary statistics used at <em>ABC</em> methods. This example shows how the asymptotic <span>$\alpha$</span> is affected by linkage and background selection.</p><p>Before start, you need to set up a variable of type <em>MKtest.parameters</em>. It is a Mutable structure containing the parameters required to solve the analytical approach. Any value at <code>MKtest.parameters</code> can be easily changed. Remember you need to define before the execution. Otherwise, <span>$\alpha_{(x)}$</span> will be solved with default values. To change all the values at once, check the variables at the struct <a href="../reference/#MKtest.parameters"><code>MKtest.parameters</code></a> to set specific models.</p><h4 id="Load-the-modules"><a class="docs-heading-anchor" href="#Load-the-modules">Load the modules</a><a id="Load-the-modules-1"></a><a class="docs-heading-anchor-permalink" href="#Load-the-modules" title="Permalink"></a></h4><pre><code class="language-julia hljs">using MKtest</code></pre><h4 id="Setting-model-parameters-and-convolute-the-binomial-distribution."><a class="docs-heading-anchor" href="#Setting-model-parameters-and-convolute-the-binomial-distribution.">Setting model parameters and convolute the binomial distribution.</a><a id="Setting-model-parameters-and-convolute-the-binomial-distribution.-1"></a><a class="docs-heading-anchor-permalink" href="#Setting-model-parameters-and-convolute-the-binomial-distribution." title="Permalink"></a></h4><p>We set a global adaptation rate of 0.4 with a contribution of 0.2 regarding weak adaptation. The process is modeled using a selection coefficient of 500, 10 for strongly and weakly beneficial alleles. We modeled the DFE for deleterious alleles using the values provided at <a href="https://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.1000083">Boyko et al. (2008)</a>. </p><pre><code class="language-julia hljs">adap = MKtest.parameters(n=661,al_tot=0.4,al_low=0.2,gH=500,gam_neg=-457,al=0.184,be = 0.184/457,B=0.999)</code></pre><h4 id="Solving-the-model"><a class="docs-heading-anchor" href="#Solving-the-model">Solving the model</a><a id="Solving-the-model-1"></a><a class="docs-heading-anchor-permalink" href="#Solving-the-model" title="Permalink"></a></h4><p>Here we solve <span>$\alpha_{(x)}$</span> generally, using the expected rates. We are not considering any specific mutation process over a locus and branch time. We used the fixation and polymorphic rates since the locus length (<span>$L$</span>) and the time branch (<span>$T$</span>) estimations at first order <span>$\alpha_{(x)}$</span> estimation can be cancelled</p><p class="math-container">\[\mathbb{E}[\alpha_{(x)}] \approx 1 - \frac{LT(\mathbb{E}[d_S])}{LT(\mathbb{E}[d_N])} \frac{LT(\mathbb{E}[p_{S(x)}])}{LT(\mathbb{E}[p_{N(x)}])} \approx 1 - \frac{\mathbb{E}[d_S]}{\mathbb{E}[d_N]} \frac{\mathbb{E}[p_{S(x)}]}{\mathbb{E}[p_{N(x)}]}\]</p><p>where <span>$\frac{LT}{LT}$</span> with a constant mutation rate tend to <span>$1$</span>. </p><pre><code class="language-julia hljs">x,y = MKtest.analytical_alpha(param = adap)</code></pre><p>Internally the function (1) sets the mutation rate regarding the BGS strength and (2) sets the probability of fixations given the genetic scenario. Then, it estimates the SFS and fixations rates for neutral and non-neutral alleles. Please check <a href="../reference/#MKtest.analytical_alpha"><code>MKtest.analytical_alpha</code></a> to check the process.</p><h4 id="Plotting-the-results."><a class="docs-heading-anchor" href="#Plotting-the-results.">Plotting the results.</a><a id="Plotting-the-results.-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting-the-results." title="Permalink"></a></h4><p>The variable <em>x</em> contains <span>$\alpha_{(x)}$</span> accounting for weakly beneficial alleles. <em>y</em> contains the value of <span>$\alpha_{(x)}$</span>, not accounting for weakly beneficial alleles. In this example, we do not model BGS (check <em>B</em> parameter in <em>MKtest.parameters</em> above)</p><p>In Julia, you can easily use R using the module <a href="https://github.com/JuliaInterop/RCall.jl">RCall</a>. Please check you have installed R in your system. Nonetheless, you can plot using the Julia Plots module.</p><p>If you are using our Docker or Singularity image, you don&#39;t need to install anything. Otherwise, install RCall just in case you want to plot using R</p><pre><code class="language-julia hljs">using Pkg
Pkg.add(&quot;RCall&quot;)</code></pre><pre><code class="language-julia hljs">using RCall

R&quot;&quot;&quot;
	library(ggplot2)
	library(data.table)
	df = data.table(f=seq(1,length($x)),x=$x,y=$y)
	d  = melt(df,id.vars=&#39;f&#39;)
	p = ggplot(d,aes(x=f,y=value,color=variable)) + geom_line() + geom_point() + scale_colour_manual(values=c(&#39;#30504f&#39;, &#39;#ab2710&#39;),labels = c(&quot;Neutral + deleterious alleles&quot;, &quot;All alleles&quot;)) + theme_bw()
	p
&quot;&quot;&quot;</code></pre><p><img src="https://raw.githubusercontent.com/jmurga/MKtest.jl/master/docs/src/figure1.svg" alt="image"/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../data/">Processing data »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.13 on <span class="colophon-date" title="Saturday 20 August 2022 12:20">Saturday 20 August 2022</span>. Using Julia version 1.8.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
