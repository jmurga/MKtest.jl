<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Summary statistics Â· MKtest.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://jmurga.github.io/MKtest.jl/summstat/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">MKtest.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Package Overview</span><ul><li><a class="tocitem" href="../analytical/">Analytical estimations</a></li><li><a class="tocitem" href="../data/">Processing data</a></li><li><a class="tocitem" href="../mk/">MK approaches</a></li></ul></li><li><span class="tocitem">Infering the rate and strength of adaptation</span><ul><li><a class="tocitem" href="../empirical/">Empirical estimation</a></li><li><a class="tocitem" href="../rates/">Rates</a></li><li><a class="tocitem" href="../input/">Input data</a></li><li class="is-active"><a class="tocitem" href>Summary statistics</a></li><li><a class="tocitem" href="../abc/">ABC inference</a></li><li><a class="tocitem" href="../multiple/">Multiple dataset</a></li></ul></li><li><a class="tocitem" href="../cli/">Command-Line interface</a></li><li><a class="tocitem" href="../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Infering the rate and strength of adaptation</a></li><li class="is-active"><a href>Summary statistics</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Summary statistics</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/jmurga/MKtest.jl/blob/master/docs/src/summstat.md#" title="Edit on GitHub"><span class="docs-icon fab">ï‚›</span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Summary-statistics"><a class="docs-heading-anchor" href="#Summary-statistics">Summary statistics</a><a id="Summary-statistics-1"></a><a class="docs-heading-anchor-permalink" href="#Summary-statistics" title="Permalink"></a></h1><p>To estimate summary statistics, we used the estimated analytical rates and empirical data following the description at section <a href="../empirical/">Empirical estimation</a></p><p>Before starting the summary statistics, consider parallelizing the process using Julia Distributed computing. If you are following the tutorial step by step, do not input the following commands.</p><pre><code class="language-julia hljs">using MKtest</code></pre><p>Before to compute the summary statistic, declare a model specifying the samples size and a DAC.</p><pre><code class="language-julia hljs">adap = MKtest.parameters(n=661,dac=[2,4,5,10,20,50,200,661,925])</code></pre><p>Note you can only input DAC already estimated, nonetheles you can perform any subset from the estimated DAC. To check the estimated DAC you can follow the hierarchy of the <code>h5</code> variable.</p><pre><code class="language-julia hljs">using JLD2
# Check hierarchy
h5   = jldopen(&quot;analysis/rates.jld2&quot;)
h5

JLDFile /home/jmurga/analysis/rates.jld2 (read-only)
 â””â”€ðŸ“‚ 1000
    â””â”€ðŸ“‚ 661
       â”œâ”€ðŸ”¢ models
       â”œâ”€ðŸ”¢ neut
       â”œâ”€ðŸ”¢ sel
       â”œâ”€ðŸ”¢ dsdn
       â””â”€ðŸ”¢ dac</code></pre><pre><code class="language-julia hljs"># Checking estimated dac, string pattern inside the HDF5 variable
h5[&quot;1000/661/dac&quot;]

14-element Vector{Int64}:
    1
    2
    4
    5
   10
   20
   50
  100
  200
  400
  500
  661
  925
 1000</code></pre><p>The function <code>MKtest.summary_statistics</code> use the SFS and divergence Matrix output from <code>MKtest.parse_sfs</code>. We include the argument <code>bootstrap</code> to perform bootstrap analysis following <a href="https://github.com/paula-tataru/polyDFE">polyDFE</a> manual. In the following example we boostrap the SFS and divegence file 100 times subseting 10^5 summary statistic for each dataset:</p><pre><code class="language-julia hljs">@time summstat = MKtest.summary_statistics(param=adap,h5_file=&quot;analysis/rates.jld2&quot;,sfs=sfs,divergence=divergence,analysis_folder=&quot;analysis/&quot;,summstat_size=10^5,bootstrap=100);</code></pre><p>Nonetheless, you can read your SFS and divergence files using the packages CSV and DataFrames to create the input Matrix. In such case, please be sure that sfs and divergence arguments are of type <code>Vector</code> using square braces (<code>[]</code>) comprehesion</p><pre><code class="nohighlight hljs">using CSV, DataFrames
sfs = CSV.read(&quot;/path/to/sfs_file.txt&quot;, header=false, DataFrame) |&gt; Matrix
divergence = CSV.read(&quot;/path/to/divergence_file.txt&quot;, header=false, DataFrame) |&gt; Matrix

# Note we modified both variables into a Vector using square braces ([]) comprehesion
@time summstat = MKtest.summary_statistics(param=adap,h5_file=&quot;analysis/rates.jld2&quot;,sfs=[sfs],divergence=[divergence],analysis_folder=&quot;analysis/&quot;,summstat_size=10^5,replicas=100,bootstrap=true);
</code></pre><p>The function will create summary statistic files and the observed data files (<em>summaries_N.txt</em> and <em>alpha_N.txt</em> respectively). Both files will be used to perform the ABC inference. Each file will be used to infer <span>$\alpha$</span> using the bootstrapped SFS.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../input/">Â« Input data</a><a class="docs-footer-nextpage" href="../abc/">ABC inference Â»</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.13 on <span class="colophon-date" title="Wednesday 4 May 2022 10:45">Wednesday 4 May 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
