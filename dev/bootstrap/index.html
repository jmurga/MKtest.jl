<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bootstrap · MKtest.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://jmurga.github.io/MKtest.jl/bootstrap/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">MKtest.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Package Overview</span><ul><li><a class="tocitem" href="../empirical/">Infering the rate and strength of adaptation</a></li><li><a class="tocitem" href="../rates/">Rates</a></li><li><a class="tocitem" href="../summstat/">Summary statistics</a></li><li><a class="tocitem" href="../abc/">ABC inference</a></li></ul></li><li><a class="tocitem" href="../cli/">Command-Line interface</a></li><li><a class="tocitem" href="../mk/">MK approaches</a></li><li class="is-active"><a class="tocitem" href>Bootstrap</a></li><li><a class="tocitem" href="../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Bootstrap</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bootstrap</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/jmurga/MKtest.jl/blob/master/docs/src/bootstrap.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p>We included a previously developed bootstrap pipeline to compare adaptation levels between case and non-case (control) genes (<a href="https://doi.org/10.1098/rstb.2019.0575">Enard and Petrov 2020</a> and <a href="https://doi.org/10.7554/eLife.69026">Di et al, 2021</a>])</p><p>To allow the comparision between case and control genes the bootstrap test uses a straightforward control set-building algorithm that adds control genes to a progressively growing control set, in such a way that the growing control set has the same range of values of confounding factors as the tested set of genes of interest. In addition it is possible to control for a minimum distance between case and control genes. </p><p>For TGP we included the <a href="https://raw.githubusercontent.com/jmurga/MKtest.jl/main/data/confounding_factors.txt">counfounding dataset</a> used in <a href="https://doi.org/10.7554/eLife.69026">Di et al., 2021</a>], as well basic <a href="https://raw.githubusercontent.com/jmurga/MKtest.jl/main/data/ensembl_gene_coords_v69.bed">gene coordinates information</a> need to performt the bootstrap. The counfounding dataset control for the following genomic factors:</p><ul><li>Average overall expression in 53 GTEx v7 tissues <a href="https://www.gtexportal.org/home/">GTEx Consortium, 2020</a>. We used the log (in base 2) of TPM (Transcripts Per Million).</li><li>Expression (log base 2 of TPM) in GTEx lymphocytes. Expression in immune tissues may impact the rate of sweeps.</li><li>Expression (log base 2 of TPM) in GTEx testis. Expression in testis might also impact the rate of sweeps.</li><li>deCode recombination rates 50 kb and 500 kb: recombination is expected to have a strong impact on iHS and nSL values, with larger, easier to detect sweeps in low recombination regions but also more false positive sweeps signals. The average recombination rates in the gene-centered windows are calculated using the most recent deCode recombination map <a href="https://doi.org/10.1126/science.aau1043">Halldorsson et al., 2019</a>. We use both 50 kb and 500 kb window estimates to account for the effect of varying window sizes on the estimation of this confounding factor (same logic for other factors where we also use both 50 kb and 500 kb windows).</li><li>GC content is calculated as a percentage per window in 50 kb and 500 kb windows. It is obtained from the USCS Genome Browser.</li><li>The density of coding sequences in 50 kb and 500 kb windows centered on genes. The density is calculated as the proportion of coding bases respect to the whole length of the window. Coding sequences are Ensembl v99 coding sequences.</li><li>The density of mammalian phastCons conserved elements <a href="https://doi.org/10.1101/gr.3715005">Siepel et al., 2005</a> (in 50 kb and 500 k windows), downloaded from the UCSC Genome Browser. We used a threshold considering 10% of the genome as conserved, as it is unlikely that more than 10% of the whole genome is constrained according to previous evidence <a href="https://doi.org/10.1101/gr.3715005">Siepel et al., 2005</a>. Given that each conserved segment had a score, we considered those segments above the 10% threshold as conserved.</li><li>The density of regulatory elements, as measured by the density of DNASE1 hypersensitive sites (in 50 kb and 500 kb windows) also from the UCSC Genome Browser.</li><li>The number of protein-protein interactions (PPIs) in the human protein interaction network <a href="https://doi.org/10.1093/gbe/evv055">Luisi et al., 2015</a>. We use the log (base 2) of the number of PPIs.</li><li>The gene genomic length, that is the distance between the most upstream and the most downstream transcription start sites.</li><li>The number of gene neighbors in a 50 kb window, and the same number in 500 kb window centered on the focal genes: it is the number of coding genes within 25 kb or within 250 kb.</li><li>The number of viruses that interact with a specific gene (<a href="https://doi.org/10.1098/rstb.2019.0575">Enard and Petrov 2020</a>).</li><li>The proportion of immune genes. The matched control sets have the same proportion of immune genes as disease genes, immune genes being genes annotated with the Gene Ontology terms GO:0002376 (immune system process), GO:0006952 (defense response) and/or GO:0006955 (immune response) as of May 2020 (<a href="https://doi.org/10.1093/nar/gkaa1113">Gene Ontology Consortium and Gene Ontology, 2021</a>).</li><li>The average non-synonymous polymorphism rate pN in African populations, and the the synonymous rate pS. We matched pN to build control sets of non-disease genes with the same average amount of strong purifying selection as disease genes. Also, pS can be a proxy for mutation rate and we can build control sets of non-disease genes with similar level of mutation rates.</li><li>McVicker’s B value which can be used to account for more recent selective constraint (<a href="https://doi.org/10.1371/journal.pgen.1000471">McVicker et al., 2009</a>).</li></ul><p>To run the bootstrap you must to declare a variable containing some basic information about data and bootstrap options using the function <code>MKtest.bootstrap_parameters</code>. To check all the arguments you can access to the function documentation using <code>@doc MKtest.bootstrap_parameters</code></p><pre><code class="language-julia hljs">b_param = MKtest.bootstrap_parameters(data = &quot;mktest/ensembl_list.txt&quot;, annotation = &quot;mktest/ensembl_gene_coords_v69.bed&quot;, dist = 1, rep = 3, tol = 0.05, iter = 10, factors = &quot;mktest/confounding_factors.txt&quot;, output = &quot;mktest/test&quot;)</code></pre><p>To run the bootstrap just use <code>MKtest.boostrap</code> function. It will output one file containing the case genes (<code>mktest/test_case.txt</code>) and another containing the control genes (<code>analysis/test_control.txt</code>)</p><pre><code class="language-julia hljs">MKtest.bootstrap(b_param)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../mk/">« MK approaches</a><a class="docs-footer-nextpage" href="../reference/">Reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.13 on <span class="colophon-date" title="Monday 18 September 2023 08:59">Monday 18 September 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
