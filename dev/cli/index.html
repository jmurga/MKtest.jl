<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Command-Line interface · MKtest.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://jmurga.github.io/MKtest.jl/cli/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">MKtest.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Package Overview</span><ul><li><a class="tocitem" href="../empirical/">Infering the rate and strength of adaptation</a></li><li><a class="tocitem" href="../rates/">Rates</a></li><li><a class="tocitem" href="../summstat/">Summary statistics</a></li><li><a class="tocitem" href="../abc/">ABC inference</a></li></ul></li><li class="is-active"><a class="tocitem" href>Command-Line interface</a><ul class="internal"><li><a class="tocitem" href="#Estimate-rates"><span>Estimate rates</span></a></li><li><a class="tocitem" href="#Estimate-summary-statistics"><span>Estimate summary statistics</span></a></li><li><a class="tocitem" href="#Perform-ABC-inference"><span>Perform ABC inference</span></a></li></ul></li><li><a class="tocitem" href="../mk/">MK approaches</a></li><li><a class="tocitem" href="../bootstrap/">Bootstrap</a></li><li><a class="tocitem" href="../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Command-Line interface</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Command-Line interface</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/jmurga/MKtest.jl/blob/master/docs/src/cli.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Command-Line-Interface"><a class="docs-heading-anchor" href="#Command-Line-Interface">Command-Line Interface</a><a id="Command-Line-Interface-1"></a><a class="docs-heading-anchor-permalink" href="#Command-Line-Interface" title="Permalink"></a></h1><p>We develop a Command-Line Interface (CLI) in case you want to avoid Julia interpreter. You can easly download <a href="https://raw.githubusercontent.com/jmurga/MKtest.jl/master/scripts/abcmk_cli.jl">abcmk_cli.jl</a>. The CLI have different functions to perform the whole pipeline as explained in <a href="../empirical/">Infering the rate and strength of adaptation</a> section</p><pre><code class="language-bash hljs">julia abcmk_cli.jl  </code></pre><pre><code class="language-bash hljs">See --help of each command for usages  
  rates  
  summaries  
  abc</code></pre><p>To reproduce the examples you can follow the steps described at <a href="https://jmurga.github.io/MKtest.jl/dev/empirical/#Computational-pipeline-1">Empirical estimation</a> section</p><h2 id="Estimate-rates"><a class="docs-heading-anchor" href="#Estimate-rates">Estimate rates</a><a id="Estimate-rates-1"></a><a class="docs-heading-anchor-permalink" href="#Estimate-rates" title="Permalink"></a></h2><p>To perform the rate estimations you can use the function <code>rates</code> at the CLI. The function works simirarly to the function <a href="../reference/#MKtest.rates"><code>MKtest.rates</code></a>. You can check the argument at <a href="https://jmurga.github.io/MKtest.jl/dev/rates/#Estimating-fixation-and-polymorphic-rates-considering-generalized-model-of-selection-and-linkage-1">Rates</a> sectino or using the macro <code>@doc MKtest.rates</code> in the Julia interpreter.</p><pre><code class="language-julia hljs">julia -t8 abcmk_cli.jl rates --help
Function to solve analytical fixation rates and the expected SFS. The function will create N random models from prior values. Use the arguments to defined the input range for each parameter.

If rho and/or theta are not set, default values will be used (0.001).

To parallelize the estimations please be sure you start up Julia using --threads/-t option and set the number of cores.

The function returns a HDF5 file containing models solved and rates. The rates will be used to compute summary statistics required at ABC.

Please check the documentation to get more info about models parameters or detailed arguments description https://jmurga.github.io/MKtest.jl/dev/cli/ to check model

Positional Arguments:
  N: Int64
  samples: Int64
  iterations: Int64

Optional Arguments:
  --alpha: String (default: 0.1,0.9)
  --gam-dfe: String (default: -1000,-200)
  --gam-flanking: String (default: -1000,-500)
  --gL: String (default: 5,10)
  --gH: String (default: 400,1000)
  --dac: String (default: 1,2,4,5,10,20,50,100,200,400,500,661,925,1000)
  --shape: Float64 (default: 0.184)
  --rho: Float64 (default: 0.001)
  --theta: Float64 (default: 0.001)
  --cutoff: String (default: 0.0,1.0)
  --output: String (default: rates.jld2)</code></pre><pre><code class="nohighlight hljs">julia -t8 abcmk_cli.jl rates 10000 661 100000 --alpha 0.1,0.9 --gam-dfe -1000,-200 --gam-flanking -1000,-500 --gL 1,10 --gH 200,2000 --output mktest/rates_cli.jld2</code></pre><h2 id="Estimate-summary-statistics"><a class="docs-heading-anchor" href="#Estimate-summary-statistics">Estimate summary statistics</a><a id="Estimate-summary-statistics-1"></a><a class="docs-heading-anchor-permalink" href="#Estimate-summary-statistics" title="Permalink"></a></h2><p>To estimate summary statistics, we used the estimated analytical rates and empirical data following the description at section <a href="../empirical/">Empirical estimation</a>.</p><pre><code class="language-bash hljs">julia abcmk_cli summaries --help
Estimate summary statistics using observed data and analytical rates.

Positional Arguments:
  N: Int64
  samples: Int64
  data: String

Optional Arguments:
  --genes: String (default: &lt;genes.txt&gt;)
  --dac: String (default: 2,4,5,10,20,50,200,661,925)
  --cutoff: String (default: 0.0,1.0)
  --rates: String (default: rates.jld2)
  --folder: String (default: &lt;folder&gt;)
  --summsize: Int64 (default: 100000)</code></pre><pre><code class="language-bash hljs">julia abcmk_cli.jl summaries --folder mktest/ --rates mktest/rates.jld2 --samples 661 --dac 2,4,5,10,20,50,200,661,925 --summsize 1000000</code></pre><p>The function will output observed data (<em>alphas_N.txt</em>) and summary statistics (<em>summaries_N.txt</em>) in the selected folder. These file will be used at ABC inference to generate posterior distributions.</p><pre><code class="language-bash hljs">julia abcmk_cli.jl summaries --analysis_folder mktest/ --rates  mktest/rates.jld2 --samples 661 --replicas 100 --summstatSize 100000 --dac 2,4,5,10,20,50,200,661,925</code></pre><h2 id="Perform-ABC-inference"><a class="docs-heading-anchor" href="#Perform-ABC-inference">Perform ABC inference</a><a id="Perform-ABC-inference-1"></a><a class="docs-heading-anchor-permalink" href="#Perform-ABC-inference" title="Permalink"></a></h2><p>At this point, you have a folder containing summary statistics and observed data to perform ABC inference. As explained in our <a href="../">home page</a>, we performed the ABC inference using <a href="https://github.com/molpopgen/ABCreg">ABCreg</a>. However, you can used other ABC software to perform the inference.</p><p>We link <a href="https://github.com/molpopgen/ABCreg">ABCreg</a> with Julia to perform ABC inference. If you are going to use ABCreg to make inferences from our software directly, please <a href="https://doi.org/10.1186/1471-2156-10-35">cite the publication</a>. Remember you need to install ABCreg before continue. Please check <a href="../">home page</a> to install ABCreg.</p><p>It is possible to perform the inference through Julia. The function will output one file per bootstrapped replicas containing the posteriors distributions. We set the tolerance value to record 1000 values for the regression.  The posterior distributions contains five columns corresponding to:</p><ul><li>α weak: Contribution of weak selecction to <span>$\alpha$</span></li><li>α strong: Contribution of strong selecction to <span>$\alpha$</span></li><li>α weak: Adaptation rate</li><li>γ: Negative selection coefficient</li><li>β: Negative selection coefficient</li></ul><pre><code class="language-bash hljs">julia abcmk_cli.jl abc --help

Positional Arguments:
  nsumm: Int64
  tol: Float64

Optional Arguments:
  --folder: String (default: &lt;folder&gt;)
  --abcreg: String (default: reg)
</code></pre><pre><code class="language-bash hljs">julia -t8 abc 9 0.025 --folder mktest/ --S 9 --abcreg /home/jmurga/ABCreg/src/reg</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../abc/">« ABC inference</a><a class="docs-footer-nextpage" href="../mk/">MK approaches »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.13 on <span class="colophon-date" title="Monday 12 August 2024 10:03">Monday 12 August 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
