<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Summary statistics Â· MKtest.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://jmurga.github.io/MKtest.jl/summstat/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">MKtest.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Package Overview</span><ul><li><a class="tocitem" href="../empirical/">Infering the rate and strength of adaptation</a></li><li><a class="tocitem" href="../rates/">Rates</a></li><li class="is-active"><a class="tocitem" href>Summary statistics</a><ul class="internal"><li><a class="tocitem" href="#Parsing-genomic-data"><span>Parsing genomic data</span></a></li><li><a class="tocitem" href="#Estimating-summary-statistics"><span>Estimating summary statistics</span></a></li></ul></li><li><a class="tocitem" href="../abc/">ABC inference</a></li></ul></li><li><a class="tocitem" href="../cli/">Command-Line interface</a></li><li><a class="tocitem" href="../mk/">MK approaches</a></li><li><a class="tocitem" href="../bootstrap/">Bootstrap</a></li><li><a class="tocitem" href="../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Package Overview</a></li><li class="is-active"><a href>Summary statistics</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Summary statistics</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/jmurga/MKtest.jl/blob/master/docs/src/summstat.md#" title="Edit on GitHub"><span class="docs-icon fab">ï‚›</span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Summary-statistics"><a class="docs-heading-anchor" href="#Summary-statistics">Summary statistics</a><a id="Summary-statistics-1"></a><a class="docs-heading-anchor-permalink" href="#Summary-statistics" title="Permalink"></a></h1><p>To estimate summary statistics, we need to used the estimated expected fixation rates and frequency spectra as well as empirical data.</p><p>The module includes functions to parse TGP from <a href="https://doi.org/10.1038/s41559-019-0890-6">Uricchio et al. (2019)</a> and DGN from <a href="https://doi.org/10.1093/nar/gkz372 ">Murga-Moreno et al. (2019)</a>. Please to parse TGP or DGN raw data into SFS and divergence counts, first download raw files deposited in our repository:  </p><ul><li><a href="https://raw.githubusercontent.com/jmurga/MKtest.jl/master/data/tgp.txt">TGP</a></li><li><a href="https://raw.githubusercontent.com/jmurga/MKtest.jl/master/data/dgn_ral.txt">DGN Zambia population</a>  </li><li><a href="https://raw.githubusercontent.com/jmurga/MKtest.jl/master/data/dgn_zi.txt">DGN Raleigh population</a>  </li></ul><p>If you are going to parse DGN, you need to change the value of the argument <em>isoline</em> to <em>true</em>. Following the <a href="https://doi.org/10.1093/nar/gkz372">Murga-Moreno et al. (2019)</a> sample size for each population is:</p><ul><li>Zambia population: 154</li><li>RAL population: 160</li></ul><h2 id="Parsing-genomic-data"><a class="docs-heading-anchor" href="#Parsing-genomic-data">Parsing genomic data</a><a id="Parsing-genomic-data-1"></a><a class="docs-heading-anchor-permalink" href="#Parsing-genomic-data" title="Permalink"></a></h2><p>Once you have downloaded the files, you can use the function <code>MKtest.parse_sfs</code> to convert the data into SFS and divergence counts. Please check <a href="../reference/#MKtest.parse_sfs"><code>MKtest.parse_sfs</code></a> to get more info or execute:</p><pre><code class="language-julia hljs">
download(&quot;https://raw.githubusercontent.com/jmurga/MKtest.jl/master/data/tgp.txt&quot;,&quot;mktest/tgp.txt&quot;)

adap = MKtest.parameters(n=661,cutoff=[0.0,1.0])
alpha, sfs, divergence, m= MKtest.parse_sfs(adap, data = &quot;mktest/tgp.txt&quot;)</code></pre><p>It is possible to directly subset genes IDs using the same ids deposited at you data. You can use a (column list file)[https://raw.githubusercontent.com/jmurga/MKtest.jl/master/data/ensembl<em>list.txt] or (CSV-like file)[https://raw.githubusercontent.com/jmurga/MKtest.jl/main/data/test</em>nonVIPs.txt] to subset the file list. If you use CSV-like each row will be parsed independtly.</p><pre><code class="language-julia hljs">download(&quot;https://raw.githubusercontent.com/jmurga/MKtest.jl/master/data/ensembl_list.txt&quot;,&quot;mktest/ensembl_list.txt&quot;)

alpha, sfs, divergence = MKtest.parse_sfs(adap, data = &quot;mktest/tgp.txt&quot;,gene_list = &quot;mktest/ensembl_list.txt&quot;)</code></pre><pre><code class="language-julia hljs">download(&quot;https://raw.githubusercontent.com/jmurga/MKtest.jl/main/data/example_bootstrap.txt&quot;,&quot;mktest/example_bootstrap.txt&quot;)

# In our case, eachrow is a bootstrapped set
alpha, sfs, divergence, m = MKtest.parse_sfs(adap, data = &quot;mktest/tgp.txt&quot;,gene_list = &quot;mktest/example_bootstrap.txt&quot;)</code></pre><h2 id="Estimating-summary-statistics"><a class="docs-heading-anchor" href="#Estimating-summary-statistics">Estimating summary statistics</a><a id="Estimating-summary-statistics-1"></a><a class="docs-heading-anchor-permalink" href="#Estimating-summary-statistics" title="Permalink"></a></h2><p>Once you have the SFS and divergence data variable you can compute the summary statistic. To do it declare a model specifying the sample size corresponding to your data as well as the cutoff used to estimate the rates.</p><pre><code class="language-julia hljs">adap = MKtest.parameters(N=1000,n=661,dac=[2,4,5,10,20,50,200,661,925],cutoff=[0.0,1.0])</code></pre><p>Note you can only input DAC already estimated, nonetheles you can perform any subset from the estimated DAC. To check the estimated DAC you can follow the hierarchy of the hdf5 file.</p><pre><code class="language-julia hljs">using JLD2
# Check hierarchy
h5   = jldopen(&quot;mktest/rates.jld2&quot;)
h5

JLDFile /home/jmurga/mktest/rates.jld2 (read-only)
 â””â”€ðŸ“‚ 1000
    â””â”€ðŸ“‚ 661
       â””â”€ðŸ“‚ cutoff=[0.0,1.0]
          â”œâ”€ðŸ”¢ models
          â”œâ”€ðŸ”¢ neut
          â”œâ”€ðŸ”¢ sel
          â”œâ”€ðŸ”¢ dsdn
          â””â”€ðŸ”¢ dac</code></pre><pre><code class="language-julia hljs"># Checking estimated dac, string pattern inside the HDF5 variable
h5[&quot;1000/661/dac&quot;]

14-element Vector{Int64}:
    1
    2
    4
    5
   10
   20
   50
  100
  200
  400
  500
  661
  925
 1000</code></pre><p>The function <code>MKtest.summary_statistics</code> will produce the simulated (summary statistics) and obversed data to run the ABC inference</p><pre><code class="language-julia hljs">@time df = MKtest.summary_statistics(adap,h5_file=&quot;mktest/rates.jld2&quot;,sfs=sfs,divergence=divergence,analysis_folder=&quot;mktest/&quot;,summstat_size=10^5);</code></pre><p>The function will create <span>$N$</span> summary statistic files and the observed data files depending on the length of variables <code>sfs</code> and <code>divergence</code> parsed with <code>MKtest.parse_sfs</code> function (<em>summaries_N.txt</em> and <em>alpha_N.txt</em> respectively, see <a href="data.md">Data</a>). Both files will be used to perform the ABC inference.</p><p>You can also read any SFS and divergence files using the packages <code>CSV</code> and <code>DataFrames</code> to create the input Vectors. In such case, please be sure that sfs and divergence arguments are of type <code>Vector</code> using square braces (<code>[]</code>) comprehesion</p><pre><code class="nohighlight hljs">using CSV, DataFrames
sfs = CSV.read(&quot;/path/to/sfs_file.txt&quot;, header=false, DataFrame) |&gt; Matrix
divergence = CSV.read(&quot;/path/to/divergence_file.txt&quot;, header=false, DataFrame) |&gt; Matrix

# Note we modified both variables into a Vector using square braces ([]) comprehesion
@time df = MKtest.summary_statistics(adap,h5_file=&quot;mktest/rates.jld2&quot;,sfs=[sfs],divergence=[divergence],analysis_folder=&quot;mktest/&quot;,summstat_size=10^5);</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../rates/">Â« Rates</a><a class="docs-footer-nextpage" href="../abc/">ABC inference Â»</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.13 on <span class="colophon-date" title="Monday 18 September 2023 07:19">Monday 18 September 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
