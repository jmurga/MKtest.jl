<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · MKtest.jl</title><script data-outdated-warner src="assets/warner.js"></script><link rel="canonical" href="https://jmurga.github.io/MKtest.jl/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>MKtest.jl</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Docker-installation"><span>Docker installation</span></a></li><li><a class="tocitem" href="#Singularity-installation"><span>Singularity installation</span></a></li><li><a class="tocitem" href="#Scratch-installation"><span>Scratch installation</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><span class="tocitem">Package Overview</span><ul><li><a class="tocitem" href="analytical/">Analytical estimations</a></li><li><a class="tocitem" href="data/">Processing data</a></li><li><a class="tocitem" href="mk/">MK approaches</a></li></ul></li><li><span class="tocitem">Infering the rate and strength of adaptation</span><ul><li><a class="tocitem" href="empirical/">Empirical estimation</a></li><li><a class="tocitem" href="rates/">Rates</a></li><li><a class="tocitem" href="input/">Input data</a></li><li><a class="tocitem" href="summstat/">Summary statistics</a></li><li><a class="tocitem" href="abc/">ABC inference</a></li><li><a class="tocitem" href="multiple/">Multiple dataset</a></li></ul></li><li><a class="tocitem" href="cli/">Command-Line interface</a></li><li><a class="tocitem" href="reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/jmurga/MKtest.jl/blob/master/docs/src/index.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="ABC-MK"><a class="docs-heading-anchor" href="#ABC-MK">ABC-MK</a><a id="ABC-MK-1"></a><a class="docs-heading-anchor-permalink" href="#ABC-MK" title="Permalink"></a></h1><p>ABC-MK is an analytical approximation to <span>$\alpha_{(x)}$</span>. We have explored the impact of linkage and background selection at positive selected alleles sites. The package solves analytical approximations for different genetic scenarios to estimate the strength and rate of adaptation.</p><p>Our approach directly estimates <span>$\alpha_{(x)}$</span> and several statistics (<span>$B$</span>, <span>$\alpha_W$</span>, <span>$\alpha_S$</span>) associated with random DFE. In conjunction, the associated values to these DFE can be used as summary statistics at ABC methods. Therefore, our method can estimate the rate and strength of adaption in models and non-models organisms.</p><h2 id="Docker-installation"><a class="docs-heading-anchor" href="#Docker-installation">Docker installation</a><a id="Docker-installation-1"></a><a class="docs-heading-anchor-permalink" href="#Docker-installation" title="Permalink"></a></h2><p>We highly recommend using the Docker image to execute the software. The Docker image is based on Debian and includes all the software needed to run the pipeline. You can access to Debian system or Jupyter pulling the image from <a href="https://hub.docker.com/r/jmurga/mktest">Docker Hub</a>. Remember to link the folder /analysis with any folder at your <code>${HOME}</code> directory to save the results:</p><pre><code class="language-bash hljs">MYPATH=&quot;/home/jmurga/analysis/&quot;
# Pull the image
docker pull jmurga/mktest
# Run temporal docker container linking some local volume to export data. Consider to create a container.
docker run -it -v --rm ${MYPATH}:/analysis/folder jmurga/mktest
# Run jupyter notebook from docker image. Change the port if 8888 is already used
docker run -it --rm -v ${MYPATH}:/analysis/folder -p 8888:8888 jmurga/mktest /bin/bash -c &quot;jupyter-lab --ip=&#39;*&#39; --port=8888 --no-browser --allow-root&quot;</code></pre><p>To use our command-line interface, just run</p><pre><code class="language-bash hljs">docker run -it -v ${MYPATH}:/analysis/ jmurga/mktest julia /analysis/abcmk_cli.jl</code></pre><h2 id="Singularity-installation"><a class="docs-heading-anchor" href="#Singularity-installation">Singularity installation</a><a id="Singularity-installation-1"></a><a class="docs-heading-anchor-permalink" href="#Singularity-installation" title="Permalink"></a></h2><p>We have created a Singularity container to use the software in HPC systems. We have tested the software at HPC working with Slurm and HTCondor scheduler</p><pre><code class="language-singularity hljs">singularity pull --arch amd64 library://jmurga/default/mktest:latest</code></pre><p>We found a <a href="https://github.com/JuliaParallel/ClusterManagers.jl/issues/164">bug</a> regarding Singularity, ClusterManagers.jl and Slurm in our HPC tests. Please, consider to install the packages manually if your HPC works with Slurm. We provided a <a href="https://github.com/jmurga/MKtest.jl/blob/master/scripts/julia_dependencies.jl">Julia script</a> to easily install all the required packages. Just run it before to execute our <a href="cli.jl">Command-Line Interface</a>. We provide <a href="https://github.com/jmurga/MKtest.jl/blob/master/scripts/abcmkSlurm.sh">Slurm</a> and <a href="https://github.com/jmurga/MKtest.jl/blob/master/scripts/abcmkHtcondor.sub">HTCondor</a> examples showing the  estimation.</p><h2 id="Scratch-installation"><a class="docs-heading-anchor" href="#Scratch-installation">Scratch installation</a><a id="Scratch-installation-1"></a><a class="docs-heading-anchor-permalink" href="#Scratch-installation" title="Permalink"></a></h2><p>To install our module from scratch, we highly recommend using <a href="https://julialang.org/downloads/">LTS official Julia binaries</a>. Once you have installed Julia in your system, consider to install some important dependencies to automatize your ABC-MK pipelines. We have prepared a file to install them. Please download <a href="https://raw.githubusercontent.com/jmurga/MKtest.jl/master/scripts/julia_dependencies.jl">this file</a> and execute the following command</p><pre><code class="language-bash hljs">curl -o julia_dependencies.jl https://raw.githubusercontent.com/jmurga/MKtest.jl/master/scripts/julia_dependencies.jl
julia julia_dependencies.jl</code></pre><p>You can easly install our Julia package executing</p><pre><code class="language-bash hljs">julia -e &#39;using Pkg;Pkg.add(PackageSpec(path=&quot;https://github.com/jmurga/MKtest.jl&quot;))&#39;</code></pre><p>Or from Pkg REPL (by pressing <code>]</code> at Julia interpreter):</p><pre><code class="language-julia hljs">add https://github.com/jmurga/MKtest.jl</code></pre><h3 id="ABCreg"><a class="docs-heading-anchor" href="#ABCreg">ABCreg</a><a id="ABCreg-1"></a><a class="docs-heading-anchor-permalink" href="#ABCreg" title="Permalink"></a></h3><p>We have linked <a href="https://github.com/molpopgen/ABCreg">ABCreg</a> with Julia to perform ABC inference. Nonetheless others ABC softwares could be used (<a href="https://doi.org/10.1111/j.2041-210X.2011.00179.x">abc (R package)</a>, <a href="https://doi.org/10.1186/1471-2105-11-116">ABCToolBox</a>, etc). If you are going to use ABCreg to directly make inference from our software please <a href="https://doi.org/10.1186/1471-2156-10-35">cite the publication</a> and compile it in your system. Anyway, once you get the summary statistic files you can use any other ABC software.</p><p>ABCreg needs <em>GSL</em> and <em>libz</em> to work. Please install both libraries before compile the software:</p><pre><code class="language-bash hljs"># Linux debian-based installation
sudo apt install libgsl-dev libz-dev build-essential git
# MacOS installation
/bin/bash -c &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)&quot;
brew install GSL zlib git</code></pre><pre><code class="language-bash hljs">git clone https://github.com/molpopgen/ABCreg.git ABCreg
cd ABCreg/src &amp;&amp; make</code></pre><h3 id="R"><a class="docs-heading-anchor" href="#R">R</a><a id="R-1"></a><a class="docs-heading-anchor-permalink" href="#R" title="Permalink"></a></h3><p>We have used R to estimate the Maximum-A-Posteriori (MAP) from posterior distributions following ABCreg examples. We linked Julia and R internally. The module contains functions to perform the estimations without quit the Julia session.</p><pre><code class="language-bash hljs"># Linux debian-based installation
sudo apt install r-base
# MacOS installation
brew install r</code></pre><p>If you are going to perform MAP estimates and plot using our module, be sure you have installed R and the following packages: ggplot2 and data.table, locfit. </p><pre><code class="language-R hljs">R -e &quot;install.packages(c(&#39;ggplot2&#39;,&#39;data.table&#39;,&#39;locfit&#39;))&quot;</code></pre><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><ul><li>Uricchio, L.H., Petrov, D.A. &amp; Enard, D. Exploiting selection at linked sites to infer the rate and strength of adaptation. Nat Ecol Evol 3, 977–984 (2019). <a href="https://doi.org/10.1038/s41559-019-0890-6">https://doi.org/10.1038/s41559-019-0890-6</a></li><li>Philipp W. Messer, Dmitri A. Petrov. Frequent adaptation and the McDonald–Kreitman test. Proceedings of the National Academy of Sciences May 2013, 110 (21) 8615-8620. <a href="https://doi.org/10.1073/pnas.1220835110">https://doi.org/10.1073/pnas.1220835110</a></li><li>Nordborg, M., Charlesworth, B., &amp; Charlesworth, D. (1996). The effect of recombination on background selection. Genetical Research, 67(2), 159-174. <a href="https://doi.org/10.1017/S0016672300033619">https://doi.org/10.1017/S0016672300033619</a></li><li>R R Hudson and N L Kaplan. Deleterious background selection with recombination. <a href="https://www.genetics.org/content/141/4/1605">Genetics December 1, 1995 vol. 141 no. 4 1605-1617.</a></li><li>Linkage and the limits to natural selection. N H Barton. <a href="https://www.genetics.org/content/140/2/821">Genetics June 1, 1995 vol. 140 no. 2 821-841</a></li><li>Thornton, K.R. Automating approximate Bayesian computation by local linear regression. BMC Genet 10, 35 (2009). <a href="https://doi.org/10.1186/1471-2156-10-35">https://doi.org/10.1186/1471-2156-10-35</a></li></ul></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="analytical/">Analytical estimations »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.13 on <span class="colophon-date" title="Wednesday 25 May 2022 12:10">Wednesday 25 May 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
